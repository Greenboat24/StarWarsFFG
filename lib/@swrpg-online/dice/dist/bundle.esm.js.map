{"version":3,"file":"bundle.esm.js","sources":["../src/types.ts","../src/hints.ts","../src/dice.ts","../src/pools.ts"],"sourcesContent":["export type DicePool = {\n  boostDice?: number;\n  abilityDice?: number;\n  proficiencyDice?: number;\n  setBackDice?: number;\n  difficultyDice?: number;\n  challengeDice?: number;\n  forceDice?: number;\n};\n\nexport type DiceResult = {\n  successes: number;\n  failures: number;\n  advantages: number;\n  threats: number;\n  triumphs: number;\n  despair: number;\n  lightSide: number;\n  darkSide: number;\n  hints?: string[];\n};\n\nexport type DieType =\n  | \"boost\"\n  | \"ability\"\n  | \"proficiency\"\n  | \"setback\"\n  | \"difficulty\"\n  | \"challenge\"\n  | \"force\";\n\nexport type DetailedDieResult = {\n  type: DieType;\n  roll: number;\n  result: DiceResult;\n};\n\nexport type RollResult = {\n  results: DetailedDieResult[];\n  summary: DiceResult;\n};\n\nexport const SYMBOLS = {\n  SUCCESS: \"SUCCESS\" as const,\n  FAILURE: \"FAILURE\" as const,\n  ADVANTAGE: \"ADVANTAGE\" as const,\n  THREAT: \"THREAT\" as const,\n  TRIUMPH: \"TRIUMPH\" as const,\n  DESPAIR: \"DESPAIR\" as const,\n  LIGHT: \"LIGHT\" as const,\n  DARK: \"DARK\" as const,\n} as const;\n\nexport type Symbol = keyof typeof SYMBOLS;\n\nexport type RollOptions = {\n  hints?: boolean;\n  /**\n   * Maximum number of dice allowed per die type.\n   * Default: 100\n   */\n  maxDicePerType?: number;\n  /**\n   * Maximum total number of dice allowed in a single roll.\n   * Default: 500\n   */\n  maxTotalDice?: number;\n  /**\n   * Whether to throw an error when dice limits are exceeded.\n   * If false, dice counts will be silently capped to the maximum.\n   * Default: false\n   */\n  throwOnLimitExceeded?: boolean;\n};\n","import { SYMBOLS, type Symbol } from \"./types\";\n\n// 1 advantage or 1 triumph\nconst recoverOneStrain = \"Recover one strain (may be applied more than once).\";\nconst addBoostDieToActiveAlly =\n  \"Add a boost die to the next allied active character's check.\";\nconst noticeImportantPoint =\n  \"Notice a single important point in the ongoing conflict, such as the location of a blast door's control panel or a weak point on an attack speeder.\";\nconst inflictCriticalInjury =\n  \"Inflict a Critical Injury with a successful attack that deals damage past soak (Advantage cost may vary).\";\nconst activateWeaponQuality =\n  \"Activate a weapon quality (Advantage cost may vary).\";\n\n// 2 advantage or 1 triumph\nconst performManeuver =\n  \"Perform an immediate free maneuver that does not exceed the two maneuver per turn limit.\";\nconst addSetbackDie =\n  \"Add a setback die to the targeted character's next check.\";\nconst addBoostDieToAnyAlly =\n  \"Add a boost die to any allied character's next check, including that of the active character.\";\n\n// 3 advantage or 1 triumph\nconst negateEnemy =\n  \"Negate the targeted enemy's defensive bonuses (such as the defense gained from cover, equipment, or performing the Guarded Stance maneuver) util the end of the current round.\";\nconst ignoreEnvironment =\n  \"Ignore penalizing environmental effects such as inclement weather, zero gravity, or similar circumstances until the end of the active character's next turn.\";\nconst disableOpponent =\n  \"When dealing damage to a target, have the attack disable the opponent or one piece of gear rather than dealing wounds or strain. This could include hobbling them temporarily with a shot to the leg, or disabling their comlink. This should be agreed upon by the player and the GM, and the effects are up to the GM (although Table 6-10: Critical Injury Result is a god resource to consult for possible effects). The effects should be temporary and not too excessive.\";\nconst gainDefense =\n  \"Gain + 1 melee or ranged defense until the end of the active character's next turn.\";\nconst dropWeapon =\n  \"Force the target to drop a melee or ranged weapon they are wielding.\";\n\n// 1 triumph\nconst upgradeDifficultyTargetedCharacter =\n  \"Upgrade the difficulty of the targeted character's next check.\";\nconst doSomethingVital =\n  \"Do something vital, such as shooting the controls to the nearby blast doors to seal them shut.\";\nconst upgradeAnyAllyCheck =\n  \"Upgrade any allied character's next check, including that of the current active character.\";\n\n// 2 triumph\nconst destroyEquipment =\n  \"When dealing damage to a target, have the attack destroy a piece of equipment the target is using, such as blowing up his blaster or destroying a personal shield generator.\";\n\n// 1 threat or 1 despair\nconst sufferStrain = \"The active character suffers 1 strain.\";\nconst loseManeuverBenefit =\n  \"The active character loses the benefits of a prior maneuver (such as from taking cover or assuming a Guarded Stance) until they perform the maneuver again.\";\n\n// 2 threat or 1 despair\nconst freeManeuver =\n  \"An opponent may immediately perform one free maneuver in response to the active character's check.\";\nconst addBoostDieToTargetedCharacter =\n  \"Add a boost die to the targeted character's next check.\";\nconst sufferSetback =\n  \"The active character or an allied character suffers a setback die on their next action.\";\n\n// 3 threat or 1 despair\nconst fallProne = \"The active character falls prone.\";\nconst gainSignificantAdvantage =\n  \"The active character grants the enemy a significant advantage in the ongoing encounter, such as accidentally blasting the controls to a bridge the active character was planning to use for their escape.\";\n\n// 1 despair\nconst outOfAmmo =\n  \"The character's ranged weapon imediately runs out of ammunition and may not be used for the remainder of the encounter.\";\nconst upgradeDifficultyAlliedCharacter =\n  \"Upgrade the difficulty of an allied character's next check, including that of the current active character.\";\nconst damagedItem =\n  \"The tool or melee weapon the character is using becomes damaged.\";\n\nexport type CostType = {\n  [key in Symbol]?: number;\n};\n\ntype Hint = {\n  description: string;\n  cost: CostType;\n};\n\nexport const hints: Hint[] = [\n  // 1 advantage or 1 triumph\n  {\n    description: recoverOneStrain,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 1,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: addBoostDieToActiveAlly,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 1,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: noticeImportantPoint,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 1,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: inflictCriticalInjury,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 1,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: activateWeaponQuality,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 1,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  // 2 advantage or 1 triumph\n  {\n    description: performManeuver,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 2,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: addSetbackDie,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 2,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: addBoostDieToAnyAlly,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 2,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  // 3 advantage or 1 triumph\n  {\n    description: negateEnemy,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 3,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: ignoreEnvironment,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 3,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: disableOpponent,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 3,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: gainDefense,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 3,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: dropWeapon,\n    cost: {\n      [SYMBOLS.ADVANTAGE]: 3,\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  // 1 triumph\n  {\n    description: upgradeDifficultyTargetedCharacter,\n    cost: {\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: doSomethingVital,\n    cost: {\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  {\n    description: upgradeAnyAllyCheck,\n    cost: {\n      [SYMBOLS.TRIUMPH]: 1,\n    },\n  },\n  // 2 triumph\n  {\n    description: destroyEquipment,\n    cost: {\n      [SYMBOLS.TRIUMPH]: 2,\n    },\n  },\n  // 1 threat or 1 despair\n  {\n    description: sufferStrain,\n    cost: {\n      [SYMBOLS.THREAT]: 1,\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  {\n    description: loseManeuverBenefit,\n    cost: {\n      [SYMBOLS.THREAT]: 1,\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  // 2 threat or 1 despair\n  {\n    description: freeManeuver,\n    cost: {\n      [SYMBOLS.THREAT]: 2,\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  {\n    description: addBoostDieToTargetedCharacter,\n    cost: {\n      [SYMBOLS.THREAT]: 1,\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  {\n    description: sufferSetback,\n    cost: {\n      [SYMBOLS.THREAT]: 2,\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  // 3 threat or 1 despair\n  {\n    description: fallProne,\n    cost: {\n      [SYMBOLS.THREAT]: 3,\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  {\n    description: gainSignificantAdvantage,\n    cost: {\n      [SYMBOLS.THREAT]: 3,\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  // 1 despair\n  {\n    description: outOfAmmo,\n    cost: {\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  {\n    description: upgradeDifficultyAlliedCharacter,\n    cost: {\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n  {\n    description: damagedItem,\n    cost: {\n      [SYMBOLS.DESPAIR]: 1,\n    },\n  },\n];\n\nexport function hintCostDisplayText(hint: Hint): string {\n  if (!hint.cost || Object.keys(hint.cost).length === 0) {\n    return \"No cost\";\n  }\n  const parts = Object.entries(hint.cost)\n    .filter(([_, count]) => count && count > 0)\n    .map(([symbol, count]) => {\n      const symbolName =\n        symbol.charAt(0).toUpperCase() + symbol.toLowerCase().slice(1);\n      const plural = count > 1 ? \"s\" : \"\";\n      return `${count} ${symbolName}${plural}`;\n    });\n\n  // Use \"OR\" in uppercase for clarity when multiple options exist\n  if (parts.length > 1) {\n    return parts.join(\" OR \");\n  }\n  return parts.length > 0 ? parts[0] : \"No cost\";\n}\n","import { hintCostDisplayText, hints } from \"./hints\";\nimport {\n  DicePool,\n  RollResult,\n  DiceResult,\n  DetailedDieResult,\n  RollOptions,\n} from \"./types\";\n\n// Default dice limits for performance and security\nexport const DEFAULT_MAX_DICE_PER_TYPE = 100;\nexport const DEFAULT_MAX_TOTAL_DICE = 500;\n\nconst rollDie = (sides: number): number =>\n  Math.floor(Math.random() * sides) + 1;\n\nconst boostDieResult = (roll: number): DiceResult => {\n  switch (roll) {\n    case 3:\n      return {\n        successes: 1,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 4:\n      return {\n        successes: 1,\n        failures: 0,\n        advantages: 1,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 5:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 2,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 6:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 1,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    default:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n  }\n};\n\nconst setBackDieResult = (roll: number): DiceResult => {\n  switch (roll) {\n    case 3:\n    case 4:\n      return {\n        successes: 0,\n        failures: 1,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 5:\n    case 6:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 1,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    default:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n  }\n};\n\nconst abilityDieResult = (roll: number): DiceResult => {\n  switch (roll) {\n    case 2:\n    case 3:\n      return {\n        successes: 1,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 4:\n      return {\n        successes: 2,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 5:\n    case 6:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 1,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 7:\n      return {\n        successes: 1,\n        failures: 0,\n        advantages: 1,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 8:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 2,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    default:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n  }\n};\n\nconst difficultyDieResult = (roll: number): DiceResult => {\n  switch (roll) {\n    case 2:\n      return {\n        successes: 0,\n        failures: 1,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 3:\n      return {\n        successes: 0,\n        failures: 2,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 4:\n    case 5:\n    case 6:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 1,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 7:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 2,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 8:\n      return {\n        successes: 0,\n        failures: 1,\n        advantages: 0,\n        threats: 1,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    default:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n  }\n};\n\nconst proficiencyDieResult = (roll: number): DiceResult => {\n  switch (roll) {\n    case 2:\n    case 3:\n      return {\n        successes: 1,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 4:\n    case 5:\n      return {\n        successes: 2,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 6:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 1,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 7:\n    case 8:\n    case 9:\n      return {\n        successes: 1,\n        failures: 0,\n        advantages: 1,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 10:\n    case 11:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 2,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 12:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 1,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    default:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n  }\n};\n\nconst challengeDieResult = (roll: number): DiceResult => {\n  switch (roll) {\n    case 2:\n    case 3:\n      return {\n        successes: 0,\n        failures: 1,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 4:\n    case 5:\n      return {\n        successes: 0,\n        failures: 2,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 6:\n    case 7:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 1,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 8:\n    case 9:\n      return {\n        successes: 0,\n        failures: 1,\n        advantages: 0,\n        threats: 1,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 10:\n    case 11:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 2,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    case 12:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 1,\n        lightSide: 0,\n        darkSide: 0,\n      };\n    default:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n  }\n};\n\nconst forceDieResult = (roll: number): DiceResult => {\n  switch (roll) {\n    case 1:\n    case 2:\n    case 3:\n    case 4:\n    case 5:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 1,\n        darkSide: 0,\n      };\n    case 6:\n    case 7:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 2,\n        darkSide: 0,\n      };\n    case 8:\n    case 9:\n    case 10:\n    case 11:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 1,\n      };\n    case 12:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 2,\n      };\n    default:\n      return {\n        successes: 0,\n        failures: 0,\n        advantages: 0,\n        threats: 0,\n        triumphs: 0,\n        despair: 0,\n        lightSide: 0,\n        darkSide: 0,\n      };\n  }\n};\n\nconst sumResults = (\n  results: DiceResult[],\n  options?: RollOptions,\n): DiceResult => {\n  const sums = results.reduce(\n    (acc, curr) => ({\n      successes: acc.successes + curr.successes,\n      failures: acc.failures + curr.failures,\n      advantages: acc.advantages + curr.advantages,\n      threats: acc.threats + curr.threats,\n      triumphs: acc.triumphs + curr.triumphs,\n      despair: acc.despair + curr.despair,\n      lightSide: acc.lightSide + (curr.lightSide || 0),\n      darkSide: acc.darkSide + (curr.darkSide || 0),\n    }),\n    {\n      successes: 0,\n      failures: 0,\n      advantages: 0,\n      threats: 0,\n      triumphs: 0,\n      despair: 0,\n      lightSide: 0,\n      darkSide: 0,\n    },\n  );\n\n  let netSuccesses = 0;\n  let netFailures = 0;\n\n  if (sums.successes === sums.failures) {\n    netSuccesses = 0;\n    netFailures = 0;\n  } else if (sums.successes > sums.failures) {\n    netSuccesses = sums.successes - sums.failures;\n  } else {\n    netFailures = sums.failures - sums.successes;\n  }\n\n  const result: DiceResult = {\n    successes: netSuccesses,\n    failures: netFailures,\n    advantages: sums.advantages,\n    threats: sums.threats,\n    triumphs: sums.triumphs,\n    despair: sums.despair,\n    lightSide: sums.lightSide,\n    darkSide: sums.darkSide,\n  };\n\n  return result;\n};\n\n/**\n * Rolls a dice pool and returns the results.\n *\n * @param pool - The dice pool to roll\n * @param options - Optional roll configuration including dice limits\n * @returns The roll results with detailed die information and summary\n * @throws {Error} If dice counts exceed configured limits\n *\n * Default limits:\n * - Max dice per type: 100 (configurable via options.maxDicePerType)\n * - Max total dice: 500 (configurable via options.maxTotalDice)\n */\nexport const roll = (pool: DicePool, options?: RollOptions): RollResult => {\n  const boostCount = pool.boostDice ?? 0;\n  const abilityCount = pool.abilityDice ?? 0;\n  const proficiencyCount = pool.proficiencyDice ?? 0;\n  const setBackCount = pool.setBackDice ?? 0;\n  const difficultyCount = pool.difficultyDice ?? 0;\n  const challengeCount = pool.challengeDice ?? 0;\n  const forceCount = pool.forceDice ?? 0;\n\n  // Get limits from options or use defaults\n  const maxDicePerType = options?.maxDicePerType ?? DEFAULT_MAX_DICE_PER_TYPE;\n  const maxTotalDice = options?.maxTotalDice ?? DEFAULT_MAX_TOTAL_DICE;\n\n  // Ensure all dice counts are non-negative and apply per-type limits\n  const sanitizedPool = {\n    boostDice: Math.max(0, Math.min(boostCount, maxDicePerType)),\n    abilityDice: Math.max(0, Math.min(abilityCount, maxDicePerType)),\n    proficiencyDice: Math.max(0, Math.min(proficiencyCount, maxDicePerType)),\n    setBackDice: Math.max(0, Math.min(setBackCount, maxDicePerType)),\n    difficultyDice: Math.max(0, Math.min(difficultyCount, maxDicePerType)),\n    challengeDice: Math.max(0, Math.min(challengeCount, maxDicePerType)),\n    forceDice: Math.max(0, Math.min(forceCount, maxDicePerType)),\n  };\n\n  // Check if any dice counts exceeded the per-type limit\n  const exceedsPerTypeLimit =\n    boostCount > maxDicePerType ||\n    abilityCount > maxDicePerType ||\n    proficiencyCount > maxDicePerType ||\n    setBackCount > maxDicePerType ||\n    difficultyCount > maxDicePerType ||\n    challengeCount > maxDicePerType ||\n    forceCount > maxDicePerType;\n\n  // Calculate total dice count\n  const totalDice =\n    sanitizedPool.boostDice +\n    sanitizedPool.abilityDice +\n    sanitizedPool.proficiencyDice +\n    sanitizedPool.setBackDice +\n    sanitizedPool.difficultyDice +\n    sanitizedPool.challengeDice +\n    sanitizedPool.forceDice;\n\n  // Check total dice limit\n  if (totalDice > maxTotalDice) {\n    throw new Error(\n      `Total dice count (${totalDice}) exceeds maximum allowed (${maxTotalDice}). ` +\n        `Please reduce the number of dice in your pool.`,\n    );\n  }\n\n  // Warn if per-type limits were exceeded (but continue with capped values)\n  if (exceedsPerTypeLimit && options?.throwOnLimitExceeded) {\n    const exceeded = [];\n    if (boostCount > maxDicePerType) exceeded.push(`boost: ${boostCount}`);\n    if (abilityCount > maxDicePerType)\n      exceeded.push(`ability: ${abilityCount}`);\n    if (proficiencyCount > maxDicePerType)\n      exceeded.push(`proficiency: ${proficiencyCount}`);\n    if (setBackCount > maxDicePerType)\n      exceeded.push(`setback: ${setBackCount}`);\n    if (difficultyCount > maxDicePerType)\n      exceeded.push(`difficulty: ${difficultyCount}`);\n    if (challengeCount > maxDicePerType)\n      exceeded.push(`challenge: ${challengeCount}`);\n    if (forceCount > maxDicePerType) exceeded.push(`force: ${forceCount}`);\n\n    throw new Error(\n      `Dice counts exceed per-type limit (${maxDicePerType}): ${exceeded.join(\", \")}. ` +\n        `Dice counts have been capped to the maximum.`,\n    );\n  }\n\n  const detailedResults: DetailedDieResult[] = [];\n\n  // Roll boost dice\n  for (let i = 0; i < sanitizedPool.boostDice; i++) {\n    const roll = rollDie(6);\n    detailedResults.push({\n      type: \"boost\",\n      roll,\n      result: boostDieResult(roll),\n    });\n  }\n\n  // Roll ability dice\n  for (let i = 0; i < sanitizedPool.abilityDice; i++) {\n    const roll = rollDie(8);\n    detailedResults.push({\n      type: \"ability\",\n      roll,\n      result: abilityDieResult(roll),\n    });\n  }\n\n  // Roll proficiency dice\n  for (let i = 0; i < sanitizedPool.proficiencyDice; i++) {\n    const roll = rollDie(12);\n    detailedResults.push({\n      type: \"proficiency\",\n      roll,\n      result: proficiencyDieResult(roll),\n    });\n  }\n\n  // Roll setback dice\n  for (let i = 0; i < sanitizedPool.setBackDice; i++) {\n    const roll = rollDie(6);\n    detailedResults.push({\n      type: \"setback\",\n      roll,\n      result: setBackDieResult(roll),\n    });\n  }\n\n  // Roll difficulty dice\n  for (let i = 0; i < sanitizedPool.difficultyDice; i++) {\n    const roll = rollDie(8);\n    detailedResults.push({\n      type: \"difficulty\",\n      roll,\n      result: difficultyDieResult(roll),\n    });\n  }\n\n  // Roll challenge dice\n  for (let i = 0; i < sanitizedPool.challengeDice; i++) {\n    const roll = rollDie(12);\n    detailedResults.push({\n      type: \"challenge\",\n      roll,\n      result: challengeDieResult(roll),\n    });\n  }\n\n  // Roll force dice\n  for (let i = 0; i < sanitizedPool.forceDice; i++) {\n    const roll = rollDie(12);\n    detailedResults.push({\n      type: \"force\",\n      roll,\n      result: forceDieResult(roll),\n    });\n  }\n\n  const summary = sumResults(detailedResults.map((r) => r.result));\n\n  if (options?.hints) {\n    const applicableHints = hints.filter((hint) => {\n      const { cost } = hint;\n      // For OR conditions: at least one option must be fully satisfied\n      // Each entry in cost represents an alternative way to pay for the hint\n      return Object.entries(cost).some(([symbol, required]) => {\n        const summaryKey = (symbol.toLowerCase() + \"s\") as keyof typeof summary;\n        const value = summary[summaryKey];\n        if (typeof value !== \"number\") return false;\n        // Check if we have enough of this symbol type to afford the hint\n        return required !== undefined && required > 0 && value >= required;\n      });\n    });\n    summary.hints = applicableHints.map(\n      (hint) => `${hintCostDisplayText(hint)} - ${hint.description}`,\n    );\n  }\n\n  return {\n    results: detailedResults,\n    summary: summary,\n  };\n};\n","import { DicePool } from \"./types\";\n\n/**\n * Creates a basic skill check dice pool\n * @param ability Number of ability (green) dice\n * @param proficiency Number of proficiency (yellow) dice\n * @returns DicePool configured for a basic skill check\n */\nexport const createSkillCheck = (\n  ability: number,\n  proficiency: number,\n): DicePool => ({\n  abilityDice: Math.max(0, ability),\n  proficiencyDice: Math.max(0, proficiency),\n});\n\n/**\n * Creates a combat check dice pool with optional boost die\n * @param ability Number of ability (green) dice\n * @param proficiency Number of proficiency (yellow) dice\n * @param boost Number of boost (blue) dice\n * @returns DicePool configured for a combat check\n */\nexport const createCombatCheck = (\n  ability: number,\n  proficiency: number,\n  boost: number = 0,\n): DicePool => ({\n  abilityDice: Math.max(0, ability),\n  proficiencyDice: Math.max(0, proficiency),\n  boostDice: Math.max(0, boost),\n});\n\n/**\n * Creates an opposed check dice pool\n * @param ability Number of ability (green) dice\n * @param proficiency Number of proficiency (yellow) dice\n * @param difficulty Number of difficulty (purple) dice\n * @param challenge Number of challenge (red) dice\n * @returns DicePool configured for an opposed check\n */\nexport const createOpposedCheck = (\n  ability: number,\n  proficiency: number,\n  difficulty: number,\n  challenge: number = 0,\n): DicePool => ({\n  abilityDice: Math.max(0, ability),\n  proficiencyDice: Math.max(0, proficiency),\n  difficultyDice: Math.max(0, difficulty),\n  challengeDice: Math.max(0, challenge),\n});\n\n/**\n * Creates a difficulty check dice pool\n * @param difficulty Number of difficulty (purple) dice\n * @param challenge Number of challenge (red) dice\n * @returns DicePool configured for a pure difficulty check\n */\nexport const createDifficultyPool = (\n  difficulty: number,\n  challenge: number = 0,\n): DicePool => ({\n  difficultyDice: Math.max(0, difficulty),\n  challengeDice: Math.max(0, challenge),\n});\n"],"names":["SYMBOLS","hints","description","cost","SYMBOLS_ADVANTAGE","SYMBOLS_TRIUMPH","SYMBOLS_THREAT","SYMBOLS_DESPAIR","rollDie","sides","Math","floor","random","boostDieResult","roll","successes","failures","advantages","threats","triumphs","despair","lightSide","darkSide","setBackDieResult","abilityDieResult","difficultyDieResult","proficiencyDieResult","challengeDieResult","forceDieResult","pool","options","boostCount","_a","boostDice","abilityCount","_b","abilityDice","proficiencyCount","_c","proficiencyDice","setBackCount","_d","setBackDice","difficultyCount","_e","difficultyDice","challengeCount","_f","challengeDice","forceCount","_g","forceDice","maxDicePerType","_h","maxTotalDice","_j","sanitizedPool","max","min","exceedsPerTypeLimit","totalDice","Error","throwOnLimitExceeded","exceeded","push","join","detailedResults","i","type","result","summary","results","sums","reduce","acc","curr","netSuccesses","netFailures","sumResults","map","r","applicableHints","filter","hint","Object","entries","some","symbol","required","summaryKey","toLowerCase","value","undefined","keys","length","parts","_","count","charAt","toUpperCase","slice","hintCostDisplayText","createSkillCheck","ability","proficiency","createCombatCheck","boost","createOpposedCheck","difficulty","challenge","createDifficultyPool"],"mappings":"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"}